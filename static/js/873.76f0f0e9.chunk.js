"use strict";(self.webpackChunkderiv_trading_app=self.webpackChunkderiv_trading_app||[]).push([[873],{4873:function(e,n,t){t.r(n),t.d(n,{default:function(){return je}});var r,i,s,o=t(168),a=t(9439),c=t(2791),l=t(2034),d=t.n(l),u=t(1475),h=t.n(u),v=t(1933),m=t(7691),p=t(5888),y=t(4554),b=t(4358),f=t(1087),x=t(5987),Z=t(1413),_=t(3896),g=t(184),k=["children","value","index"],j=(0,m.ZP)((function(e){return(0,g.jsx)("div",{className:e.className,children:(0,g.jsx)(_.Z,(0,Z.Z)({},e))})}))(r||(r=(0,o.Z)(["\n  .MuiBox-root {\n    background: red;\n  }\n"]))),w=(0,m.ZP)((function(e){return(0,g.jsx)("div",{className:e.className,children:(0,g.jsx)(_.Z,(0,Z.Z)({},e))})}))(i||(i=(0,o.Z)(["\n  .MuiTabs-root {\n    min-height: auto;\n  }\n  .MuiTab-root {\n    padding: 5px 15px !important;\n    min-height: auto;\n  }\n  .Mui-selected {\n    background: #ff444f !important;\n    color: white !important;\n    border-radius: 20px;\n  }\n  .ant-tabs-tab-active {\n    .ant-tabs-tab-btn {\n      background: #ff444f;\n      font-weight: normal;\n      color: white !important;\n    }\n  }\n"]))),T=(0,m.ZP)((function(e){var n=e.children,t=e.value,r=e.index,i=(0,x.Z)(e,k);return(0,g.jsx)("div",(0,Z.Z)((0,Z.Z)({role:"tabpanel",hidden:t!==r,id:"simple-tabpanel-".concat(r),"aria-labelledby":"simple-tab-".concat(r)},i),{},{children:t===r&&(0,g.jsx)(y.Z,{sx:{pt:4},children:(0,g.jsx)(y.Z,{children:n})})}))}))(s||(s=(0,o.Z)([""]))),E=t(4165),S=t(5861),C=t(5671),P=t(3144),A=t(9909),L=t.n(A),R=function(){function e(){(0,C.Z)(this,e),this._socketConnection=void 0,this._derivAPI=void 0,this._socketConnection=new WebSocket("".concat({NODE_ENV:"production",PUBLIC_URL:"/trading-app",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.REACT_APP_SOCKET_BASE_URL,"?app_id=").concat({NODE_ENV:"production",PUBLIC_URL:"/trading-app",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.REACT_APP_ID)),this._derivAPI=new(L())({connection:this._socketConnection})}return(0,P.Z)(e,[{key:"derivAPI",get:function(){return this._derivAPI}},{key:"socketConnection",get:function(){return this._socketConnection}}],[{key:"getInstance",value:function(){return e._instance||(e._instance=new e),e._instance}}]),e}();R._instance=void 0;var M,N=Object.freeze(R.getInstance()),O=function(){return(new Date).getTime()+Math.floor(1e4*Math.random())},F=function(){function e(){(0,C.Z)(this,e)}return(0,P.Z)(e,null,[{key:"validateResponse",value:function(e){var n=!1,t=!1,r=e.data,i=e.messageType,s=e.id;return r.req_id===s&&r.msg_type===i&&(t=!0,r.error&&(n=!0)),{hasError:n,isEqualToMessageType:t}}}]),e}(),H=t(8203),I=function(){function e(){(0,C.Z)(this,e)}return(0,P.Z)(e,null,[{key:"activeSymbolApiResponseTransformer",value:function(e){return d()(e.active_symbols,(function(e){return{allow_forward_starting:Boolean(e.allow_forward_starting),display_name:e.display_name,display_order:e.display_name,exchange_is_open:Boolean(e.exchange_is_open),is_trading_suspended:Boolean(e.is_trading_suspended),market:e.market,market_display_name:e.market_display_name,pip:e.pip,subgroup:e.subgroup,subgroup_display_name:e.subgroup_display_name,submarket:e.submarket,submarket_display_name:e.submarket_display_name,symbol:e.symbol,symbol_type:e.symbol_type}}))}},{key:"symbolStreamTransformer",value:function(e){return{timestamp:e.ohlc.epoch,open:parseFloat(e.ohlc.open),close:parseFloat(e.ohlc.close),high:parseFloat(e.ohlc.high),low:parseFloat(e.ohlc.low)}}}]),e}(),D=function(){function e(){(0,C.Z)(this,e)}return(0,P.Z)(e,null,[{key:"retrieveSymbols",value:function(){var e=(0,S.Z)((0,E.Z)().mark((function e(n){var t,r,i,s;return(0,E.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=n.activeSymbols,r=n.productType,i=O(),s={req_id:i,active_symbols:t,product_type:r},e.abrupt("return",new Promise((function(e,n){N.socketConnection.addEventListener("message",(function t(r){try{var s=JSON.parse(r.data),o=F.validateResponse({data:s,messageType:"active_symbols",id:i});if(o.isEqualToMessageType){o.hasError&&(N.socketConnection.removeEventListener("message",t),n(s));var a=I.activeSymbolApiResponseTransformer(s);e(a)}}catch(c){n(c)}finally{N.socketConnection.removeEventListener("message",t)}})),N.derivAPI.activeSymbols(s)})));case 4:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}()},{key:"retrieveTicksHistory",value:function(){var e=(0,S.Z)((0,E.Z)().mark((function e(n){var t,r;return(0,E.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=O(),r=(0,Z.Z)((0,Z.Z)({},n),{},{req_id:t}),e.abrupt("return",new Promise((function(e,n){N.socketConnection.addEventListener("message",(function r(i){try{var s=JSON.parse(i.data),o=F.validateResponse({data:s,messageType:"candles",id:t});o.isEqualToMessageType&&(o.hasError&&(N.socketConnection.removeEventListener("message",r),n(new Error)),N.socketConnection.removeEventListener("message",r),e(s.candles))}catch(a){console.log("error"),n(a)}})),N.derivAPI.ticksHistory(r)})));case 3:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}()},{key:"subscribeTicks",value:function(e){var n=O(),t=(0,Z.Z)((0,Z.Z)({},e),{},{req_id:n,subscribe:1}),r=new H.x,i=function e(t){try{var i=JSON.parse(t.data),s=F.validateResponse({data:i,messageType:"ohlc",id:n});if(s.isEqualToMessageType){s.hasError&&(N.socketConnection.removeEventListener("message",e),r.error(new Error));var o=I.symbolStreamTransformer(i);r.next(o)}}catch(a){N.socketConnection.removeEventListener("message",e,!1),r.error(a)}};return N.socketConnection.addEventListener("message",i),N.derivAPI.ticksHistory(t),{observable:r,unsubscribe:function(){N.socketConnection.removeEventListener("message",i),r.complete()}}}}]),e}(),q=D,K=t(8444),W=t.n(K),B=function(){function e(){(0,C.Z)(this,e)}return(0,P.Z)(e,null,[{key:"prepareActiveSymbolApiResponseForView",value:function(e){if(!e)return[];var n=W()(e,"market");return d()(n,(function(e){var n=W()(e,"submarket"),t=d()(n,(function(e){return{key:e[0].submarket,label:e[0].submarket_display_name,symbols:e}}));return{key:e[0].market,label:e[0].market_display_name,subMarkets:t}}))}}]),e}(),U=t(7924),V=t(5519),z=t(9836),J=t(3382),Q=t(6890),G=t(5855),X=t(7047),Y=t(1582),$=t(890),ee=t(6151),ne=t(8745),te=t(2426),re=t.n(te),ie=t(7),se=t(2460),oe=t(5678),ae=t(5172),ce=t(6683),le=t.n(ce),de=t(189),ue=t(5667),he=t(2891),ve=t(466),me=t(3142),pe=t(8004),ye=function(e){var n=e.tradingHistory,t=e.priceDifference,r=le()(n,(function(e,n){return n.close<e.close?n:e})),i=le()(n,(function(e,n){return n.close>e.close?n:e}));return(0,g.jsx)("div",{children:(0,g.jsxs)(de.w,{width:300,height:50,data:n,children:[(0,g.jsx)(ue.u,{}),(0,g.jsx)(he.B,{domain:["dataMin","dataMax"],hide:!0}),(0,g.jsx)(ve.K,{dataKey:"epoch",hide:!0}),(0,g.jsx)(me.x,{strokeWidth:2,type:"monotone",dataKey:"close",stroke:t>0?ie.Z[500]:se.Z[500],dot:!1}),(0,g.jsx)(pe.q,{y:null===i||void 0===i?void 0:i.close,x:null===i||void 0===i?void 0:i.epoch,r:5,fill:"black"}),(0,g.jsx)(pe.q,{y:null===r||void 0===r?void 0:r.close,x:null===r||void 0===r?void 0:r.epoch,r:5,fill:"black"})]})})},be=function(e){var n,t,r,i=e.symbol,s=(0,c.useState)(null),o=(0,a.Z)(s,2),l=o[0],d=o[1],u=(0,v.useQuery)(["retrieveTicksHistory",i.symbol],(function(){var e=re()().subtract(24,"hour").unix(),n={ticks_history:i.symbol,adjust_start_time:1,count:5e3,end:"latest",start:e,style:"candles"};return q.retrieveTicksHistory(n)})),h=(u.isLoading,u.error,u.data);(0,c.useEffect)((function(){var e={ticks_history:i.symbol,adjust_start_time:1,count:10,end:"latest",start:1,style:"candles",subscribe:1},n=q.subscribeTicks(e),t=n.observable,r=n.unsubscribe;return t.subscribe((function(e){d(e)})),function(){r()}}),[i]);var m=0;if(h&&l){var p,b,f=null!==(p=null===h||void 0===h?void 0:h[0].close)&&void 0!==p?p:0;m=(null!==(b=null===l||void 0===l?void 0:l.close)&&void 0!==b?b:0)-f}return null!==h&&void 0!==h&&h.length&&!l&&(m=h[h.length-1].close-h[0].close),(0,g.jsxs)(G.Z,{children:[(0,g.jsx)(ne.Z,{width:"20%",children:i.display_name}),(0,g.jsx)(ne.Z,{width:"20%",children:null!==(n=null!==(t=null===l||void 0===l?void 0:l.close.toFixed(4))&&void 0!==t?t:null===h||void 0===h||null===(r=h[h.length-1])||void 0===r?void 0:r.close.toFixed(4))&&void 0!==n?n:(0,g.jsx)(X.Z,{variant:"rounded",width:100,height:20})}),(0,g.jsx)(ne.Z,{width:"20%",children:h||l?(0,g.jsx)(y.Z,{color:m>0?ie.Z[500]:m<0?se.Z[500]:"black",children:m>0?(0,g.jsxs)(Y.Z,{direction:"row",children:[(0,g.jsx)(y.Z,{children:(0,g.jsx)(oe.Z,{})}),(0,g.jsx)($.Z,{children:m.toFixed(4)})]}):m<0?(0,g.jsxs)(Y.Z,{direction:"row",children:[(0,g.jsx)(y.Z,{children:(0,g.jsx)(ae.Z,{})}),(0,g.jsx)($.Z,{children:m.toFixed(4)})]}):(0,g.jsx)(Y.Z,{direction:"row",children:(0,g.jsx)($.Z,{children:m.toFixed(4)})})}):(0,g.jsx)(X.Z,{variant:"rounded",width:100,height:20})}),(0,g.jsx)(ne.Z,{width:"20%",children:h?(0,g.jsx)(ye,{tradingHistory:h,priceDifference:m}):(0,g.jsx)(X.Z,{variant:"rounded",width:100,height:20})}),(0,g.jsx)(ne.Z,{align:"right",children:(0,g.jsx)(ee.Z,{variant:"outlined",color:"primary",disabled:!i.exchange_is_open||i.is_trading_suspended,children:"Trade"})})]})},fe=t(4942),xe=t(6934),Ze=t(618),_e=(0,xe.ZP)(ne.Z)((function(e){var n;e.theme;return n={},(0,fe.Z)(n,"&.".concat(Ze.Z.head),{color:"#9b9b9b"}),(0,fe.Z)(n,"&.".concat(Ze.Z.body),{fontSize:14}),n})),ge=function(e){var n=e.symbols;return(0,g.jsxs)(z.Z,{sx:{minWidth:700},"aria-label":"customized table",children:[(0,g.jsx)(Q.Z,{children:(0,g.jsxs)(G.Z,{children:[(0,g.jsx)(_e,{children:"Name"}),(0,g.jsx)(_e,{children:"Last Price"}),(0,g.jsx)(_e,{children:"24h change"}),(0,g.jsx)(_e,{children:"\xa0"}),(0,g.jsx)(_e,{children:"\xa0"})]})}),(0,g.jsx)(J.Z,{children:d()(n,(function(e,n){return(0,g.jsx)(be,{symbol:e},n)}))})]})},ke=function(){return(0,g.jsxs)(y.Z,{children:[(0,g.jsxs)(Y.Z,{direction:"row",spacing:2,children:[(0,g.jsx)(X.Z,{width:100,height:60}),(0,g.jsx)(X.Z,{width:100,height:60}),(0,g.jsx)(X.Z,{width:100,height:60}),(0,g.jsx)(X.Z,{width:100,height:60}),(0,g.jsx)(X.Z,{width:100,height:60}),(0,g.jsx)(X.Z,{width:100,height:60})]}),(0,g.jsx)(U.Z,{}),(0,g.jsxs)(Y.Z,{mt:1,children:[(0,g.jsx)(X.Z,{height:20}),(0,g.jsx)(X.Z,{height:20}),(0,g.jsx)(X.Z,{height:20}),(0,g.jsx)(X.Z,{height:20})]})]})},je=(0,m.ZP)((function(){var e=(0,c.useState)(0),n=(0,a.Z)(e,2),t=n[0],r=n[1],i=(0,c.useState)(0),s=(0,a.Z)(i,2),o=s[0],l=s[1],u=(0,c.useState)(!1),m=(0,a.Z)(u,2),x=m[0],Z=m[1],_=(0,f.lr)(),k=(0,a.Z)(_,2),E=k[0],S=k[1],C=(0,v.useQuery)(["retrieveSymbols"],(function(){return q.retrieveSymbols({activeSymbols:"brief",productType:"basic"})})),P=C.isLoading,A=C.error,L=C.data,R=(0,c.useMemo)((function(){return B.prepareActiveSymbolApiResponseForView(L)}),[L]),M=function(e,n){S({market:R[t].key,submarket:R[t].subMarkets[n].key})};return(0,c.useEffect)((function(){var e=function(){Z(!0)};return N.socketConnection.addEventListener("error",e),function(){N.socketConnection.removeEventListener("error",e)}}),[]),(0,c.useEffect)((function(){if(R.length){var e=h()(R,{key:E.get("market")||void 0});r(e<0?0:e);var n=h()(R[t].subMarkets,{key:E.get("submarket")||void 0});l(n<0?0:n)}}),[E,R]),(0,g.jsxs)("div",{children:[A||x?(0,g.jsx)(y.Z,{className:"page-content",my:5,children:(0,g.jsx)(b.Z,{severity:"error",children:"The Network connection is lost, Please refresh page"})}):null,P&&!x?(0,g.jsx)(y.Z,{className:"page-content",children:(0,g.jsx)(ke,{})}):null,P||x?null:(0,g.jsxs)(g.Fragment,{children:[(0,g.jsx)(y.Z,{className:"page-content",bgcolor:V.Z[100],children:(0,g.jsx)(p.Z,{value:t,onChange:function(e,n){S({market:R[n].key})},children:d()(R,(function(e,n){return(0,g.jsx)(j,{label:e.label,value:n},e.key)}))})}),(0,g.jsx)(U.Z,{}),d()(R,(function(e,n){return(0,g.jsxs)(T,{value:t,index:n,children:[(0,g.jsx)(y.Z,{className:"page-content",children:(0,g.jsx)(p.Z,{value:o,TabIndicatorProps:{style:{display:"none"}},style:{minHeight:"auto"},onChange:M,children:d()(e.subMarkets,(function(e,n){return(0,g.jsx)(w,{label:e.label,value:n},e.key)}))})}),d()(e.subMarkets,(function(e,n){return(0,g.jsx)(T,{value:o,index:n,children:(0,g.jsx)("div",{className:"page-content",children:(0,g.jsx)(ge,{symbols:e.symbols})},e.key)},e.key)}))]},e.key)}))]})]})}))(M||(M=(0,o.Z)([""])))}}]);
//# sourceMappingURL=873.76f0f0e9.chunk.js.map